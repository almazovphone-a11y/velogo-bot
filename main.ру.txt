from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes
from datetime import datetime

BOT_TOKEN = "–¢–û–ö–ï–ù_–û–¢_BOTFATHER"
ADMIN_CHAT_ID = -1001234567890  # –∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π ID

MIN_PRICE = 149
MAX_PRICE = 249

def is_working_hours():
    now = datetime.now().hour
    return 9 <= now or now == 0

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE):
    await update.message.reply_text(
        "üö¥ –ü—Ä–∏–≤–µ—Ç! –≠—Ç–æ VeloGo_EmelyanovoBot.\n\n"
        "–ú—ã –¥–æ—Å—Ç–∞–≤–∏–º —Ç–æ–≤–∞—Ä –ø–æ –ï–º–µ–ª—å—è–Ω–æ–≤–æ –±—ã—Å—Ç—Ä–æ –∏ —É–¥–æ–±–Ω–æ!\n"
        "–ù–∞–ø–∏—à–∏, —á—Ç–æ –Ω—É–∂–Ω–æ –∫—É–ø–∏—Ç—å –∏ –∫—É–¥–∞ –¥–æ—Å—Ç–∞–≤–∏—Ç—å (–∞–¥—Ä–µ—Å)."
    )

async def handle_order(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if not is_working_hours():
        await update.message.reply_text("‚è∞ –ú—ã –ø—Ä–∏–Ω–∏–º–∞–µ–º –∑–∞–∫–∞–∑—ã —Å 09:00 –¥–æ 00:00. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ üôÇ")
        return

    order_text = update.message.text
    user = update.message.from_user
    price = MAX_PRICE if len(order_text) > 40 else MIN_PRICE

    msg_for_admin = (
        f"üì¶ –ù–æ–≤—ã–π –∑–∞–∫–∞–∑!\n"
        f"–û—Ç: {user.first_name or '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}\n"
        f"Username: @{user.username}\n"
        f"–¢–µ–∫—Å—Ç –∑–∞–∫–∞–∑–∞: {order_text}\n"
        f"üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏: {price} ‚ÇΩ"
    )

    await context.bot.send_message(chat_id=ADMIN_CHAT_ID, text=msg_for_admin)
    await update.message.reply_text(f"‚úÖ –ó–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç!\n–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ {price} ‚ÇΩ. –ö—É—Ä—å–µ—Ä —Å–∫–æ—Ä–æ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏!")

async def main():
    app = ApplicationBuilder().token(BOT_TOKEN).build()
    app.add_handler(CommandHandler("start", start))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_order))
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω üö¥")
    await app.run_polling()

import asyncio
if name == "__main__":
    asyncio.run(main())